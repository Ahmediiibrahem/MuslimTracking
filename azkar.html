<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø§Ù„Ø£Ø°ÙƒØ§Ø± ÙˆØ§Ù„ÙˆØ±Ø¯</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@700&display=swap" rel="stylesheet">

<style>
body {
    font-family: 'Cairo', sans-serif;
    background:#121212;
    color:#eee;
    padding:20px;
}

.date-box {
    max-width:260px;
    margin:auto;
    display:flex;
    flex-direction:column;
    gap:6px;
}

.date-box input {
    padding:10px;
    border-radius:8px;
    border:1px solid #444;
    background:#1f1f1f;
    color:#fff;
}

table {
    width:100%;
    border-collapse:collapse;
    margin-top:20px;
}

th, td {
    border:1px solid #444;
    padding:10px;
    text-align:center;
}

th { background:#1f1f1f; }

.box {
    width:26px;
    height:26px;
    border:1px solid #777;
    margin:auto;
    cursor:pointer;
    display:flex;
    align-items:center;
    justify-content:center;
}

.checked::after {
    content:"âœ”";
    color:#4caf50;
}

.quran-entry {
    display:flex;
    flex-wrap:wrap;
    gap:6px;
    margin-bottom:6px;
    align-items:center;
}

.quran-entry select,
.quran-entry input {
    padding:6px;
    border-radius:6px;
    border:1px solid #555;
    background:#1e1e1e;
    color:white;
    width:90px;
}

button {
    padding:6px 10px;
    border:none;
    border-radius:6px;
    cursor:pointer;
    font-weight:bold;
}

.add-quran { background:#4caf50; color:white; }
.mark { background:#4caf50; color:white; }
.edit { background:#ff9800; color:white; }
.del { background:#f44336; color:white; }

.read select,
.read input {
    pointer-events:none;
    opacity:0.6;
}

.error {
    color:#f44336;
    font-size:14px;
}
</style>
</head>
<body>

<div class="date-box">
    <label>ðŸ“… Ø§Ø®ØªØ± Ø§Ù„ÙŠÙˆÙ…</label>
    <input type="date" id="picker">
</div>

<table>
<thead>
<tr>
<th>Ø§Ù„ÙŠÙˆÙ…</th>
<th>Ø£Ø°ÙƒØ§Ø± Ø§Ù„ØµØ¨Ø§Ø­</th>
<th>Ø£Ø°ÙƒØ§Ø± Ø§Ù„Ù…Ø³Ø§Ø¡</th>
<th>Ø§Ù„ÙˆØ±Ø¯ Ø§Ù„Ù‚Ø±Ø¢Ù†ÙŠ</th>
</tr>
</thead>
<tbody id="tbody"></tbody>
</table>

<script>
const picker = document.getElementById("picker");
const tbody = document.getElementById("tbody");

const surahs = [
{n:"Ø§Ù„ÙØ§ØªØ­Ø©",a:7},{n:"Ø§Ù„Ø¨Ù‚Ø±Ø©",a:286},{n:"Ø¢Ù„ Ø¹Ù…Ø±Ø§Ù†",a:200},{n:"Ø§Ù„Ù†Ø³Ø§Ø¡",a:176},
{n:"Ø§Ù„Ù…Ø§Ø¦Ø¯Ø©",a:120},{n:"Ø§Ù„Ø£Ù†Ø¹Ø§Ù…",a:165},{n:"Ø§Ù„Ø£Ø¹Ø±Ø§Ù",a:206},{n:"Ø§Ù„Ø£Ù†ÙØ§Ù„",a:75},
{n:"Ø§Ù„ØªÙˆØ¨Ø©",a:129},{n:"ÙŠÙˆÙ†Ø³",a:109},{n:"Ù‡ÙˆØ¯",a:123},{n:"ÙŠÙˆØ³Ù",a:111},
{n:"Ø§Ù„Ø±Ø¹Ø¯",a:43},{n:"Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ…",a:52},{n:"Ø§Ù„Ø­Ø¬Ø±",a:99},{n:"Ø§Ù„Ù†Ø­Ù„",a:128},
{n:"Ø§Ù„Ø¥Ø³Ø±Ø§Ø¡",a:111},{n:"Ø§Ù„ÙƒÙ‡Ù",a:110},{n:"Ù…Ø±ÙŠÙ…",a:98},{n:"Ø·Ù‡",a:135},
{n:"Ø§Ù„Ø£Ù†Ø¨ÙŠØ§Ø¡",a:112},{n:"Ø§Ù„Ø­Ø¬",a:78},{n:"Ø§Ù„Ù…Ø¤Ù…Ù†ÙˆÙ†",a:118},{n:"Ø§Ù„Ù†ÙˆØ±",a:64},
{n:"Ø§Ù„ÙØ±Ù‚Ø§Ù†",a:77},{n:"Ø§Ù„Ø´Ø¹Ø±Ø§Ø¡",a:227},{n:"Ø§Ù„Ù†Ù…Ù„",a:93},{n:"Ø§Ù„Ù‚ØµØµ",a:88},
{n:"Ø§Ù„Ø¹Ù†ÙƒØ¨ÙˆØª",a:69},{n:"Ø§Ù„Ø±ÙˆÙ…",a:60},{n:"Ù„Ù‚Ù…Ø§Ù†",a:34},{n:"Ø§Ù„Ø³Ø¬Ø¯Ø©",a:30},
{n:"Ø§Ù„Ø£Ø­Ø²Ø§Ø¨",a:73},{n:"Ø³Ø¨Ø£",a:54},{n:"ÙØ§Ø·Ø±",a:45},{n:"ÙŠØ³",a:83},
{n:"Ø§Ù„ØµØ§ÙØ§Øª",a:182},{n:"Øµ",a:88},{n:"Ø§Ù„Ø²Ù…Ø±",a:75},{n:"ØºØ§ÙØ±",a:85},
{n:"ÙØµÙ„Øª",a:54},{n:"Ø§Ù„Ø´ÙˆØ±Ù‰",a:53},{n:"Ø§Ù„Ø²Ø®Ø±Ù",a:89},{n:"Ø§Ù„Ø¯Ø®Ø§Ù†",a:59},
{n:"Ø§Ù„Ø¬Ø§Ø«ÙŠØ©",a:37},{n:"Ø§Ù„Ø£Ø­Ù‚Ø§Ù",a:35},{n:"Ù…Ø­Ù…Ø¯",a:38},{n:"Ø§Ù„ÙØªØ­",a:29},
{n:"Ø§Ù„Ø­Ø¬Ø±Ø§Øª",a:18},{n:"Ù‚",a:45},{n:"Ø§Ù„Ø°Ø§Ø±ÙŠØ§Øª",a:60},{n:"Ø§Ù„Ø·ÙˆØ±",a:49},
{n:"Ø§Ù„Ù†Ø¬Ù…",a:62},{n:"Ø§Ù„Ù‚Ù…Ø±",a:55},{n:"Ø§Ù„Ø±Ø­Ù…Ù†",a:78},{n:"Ø§Ù„ÙˆØ§Ù‚Ø¹Ø©",a:96},
{n:"Ø§Ù„Ø­Ø¯ÙŠØ¯",a:29},{n:"Ø§Ù„Ù…Ø¬Ø§Ø¯Ù„Ø©",a:22},{n:"Ø§Ù„Ø­Ø´Ø±",a:24},{n:"Ø§Ù„Ù…Ù…ØªØ­Ù†Ø©",a:13},
{n:"Ø§Ù„ØµÙ",a:14},{n:"Ø§Ù„Ø¬Ù…Ø¹Ø©",a:11},{n:"Ø§Ù„Ù…Ù†Ø§ÙÙ‚ÙˆÙ†",a:11},{n:"Ø§Ù„ØªØºØ§Ø¨Ù†",a:18},
{n:"Ø§Ù„Ø·Ù„Ø§Ù‚",a:12},{n:"Ø§Ù„ØªØ­Ø±ÙŠÙ…",a:12},{n:"Ø§Ù„Ù…Ù„Ùƒ",a:30},{n:"Ø§Ù„Ù‚Ù„Ù…",a:52},
{n:"Ø§Ù„Ø­Ø§Ù‚Ø©",a:52},{n:"Ø§Ù„Ù…Ø¹Ø§Ø±Ø¬",a:44},{n:"Ù†ÙˆØ­",a:28},{n:"Ø§Ù„Ø¬Ù†",a:28},
{n:"Ø§Ù„Ù…Ø²Ù…Ù„",a:20},{n:"Ø§Ù„Ù…Ø¯Ø«Ø±",a:56},{n:"Ø§Ù„Ù‚ÙŠØ§Ù…Ø©",a:40},{n:"Ø§Ù„Ø¥Ù†Ø³Ø§Ù†",a:31},
{n:"Ø§Ù„Ù…Ø±Ø³Ù„Ø§Øª",a:50},{n:"Ø§Ù„Ù†Ø¨Ø£",a:40},{n:"Ø§Ù„Ù†Ø§Ø²Ø¹Ø§Øª",a:46},{n:"Ø¹Ø¨Ø³",a:42},
{n:"Ø§Ù„ØªÙƒÙˆÙŠØ±",a:29},{n:"Ø§Ù„Ø§Ù†ÙØ·Ø§Ø±",a:19},{n:"Ø§Ù„Ù…Ø·ÙÙÙŠÙ†",a:36},{n:"Ø§Ù„Ø§Ù†Ø´Ù‚Ø§Ù‚",a:25},
{n:"Ø§Ù„Ø¨Ø±ÙˆØ¬",a:22},{n:"Ø§Ù„Ø·Ø§Ø±Ù‚",a:17},{n:"Ø§Ù„Ø£Ø¹Ù„Ù‰",a:19},{n:"Ø§Ù„ØºØ§Ø´ÙŠØ©",a:26},
{n:"Ø§Ù„ÙØ¬Ø±",a:30},{n:"Ø§Ù„Ø¨Ù„Ø¯",a:20},{n:"Ø§Ù„Ø´Ù…Ø³",a:15},{n:"Ø§Ù„Ù„ÙŠÙ„",a:21},
{n:"Ø§Ù„Ø¶Ø­Ù‰",a:11},{n:"Ø§Ù„Ø´Ø±Ø­",a:8},{n:"Ø§Ù„ØªÙŠÙ†",a:8},{n:"Ø§Ù„Ø¹Ù„Ù‚",a:19},
{n:"Ø§Ù„Ù‚Ø¯Ø±",a:5},{n:"Ø§Ù„Ø¨ÙŠÙ†Ø©",a:8},{n:"Ø§Ù„Ø²Ù„Ø²Ù„Ø©",a:8},{n:"Ø§Ù„Ø¹Ø§Ø¯ÙŠØ§Øª",a:11},
{n:"Ø§Ù„Ù‚Ø§Ø±Ø¹Ø©",a:11},{n:"Ø§Ù„ØªÙƒØ§Ø«Ø±",a:8},{n:"Ø§Ù„Ø¹ØµØ±",a:3},{n:"Ø§Ù„Ù‡Ù…Ø²Ø©",a:9},
{n:"Ø§Ù„ÙÙŠÙ„",a:5},{n:"Ù‚Ø±ÙŠØ´",a:4},{n:"Ø§Ù„Ù…Ø§Ø¹ÙˆÙ†",a:7},{n:"Ø§Ù„ÙƒÙˆØ«Ø±",a:3},
{n:"Ø§Ù„ÙƒØ§ÙØ±ÙˆÙ†",a:6},{n:"Ø§Ù„Ù†ØµØ±",a:3},{n:"Ø§Ù„Ù…Ø³Ø¯",a:5},
{n:"Ø§Ù„Ø¥Ø®Ù„Ø§Øµ",a:4},{n:"Ø§Ù„ÙÙ„Ù‚",a:5},{n:"Ø§Ù„Ù†Ø§Ø³",a:6}
];

function saveAzkar(date, data) {
    localStorage.setItem("azkar_" + date, JSON.stringify(data));
}
function loadAzkar(date) {
    return JSON.parse(localStorage.getItem("azkar_" + date));
}

picker.addEventListener("change", () => {
    tbody.innerHTML = "";
    if (!picker.value) return;
    createRow(picker.value);
});

function createRow(date) {
    const saved = loadAzkar(date);

    const tr = document.createElement("tr");
    const tdDate = document.createElement("td");
    tdDate.textContent = date;
    tr.appendChild(tdDate);

    const morning = createBox();
    const evening = createBox();

    if (saved?.morning) morning.classList.add("checked");
    if (saved?.evening) evening.classList.add("checked");

    tr.appendChild(wrap(morning));
    tr.appendChild(wrap(evening));

    const qTd = document.createElement("td");
    const error = document.createElement("div");
    error.className = "error";
    qTd.appendChild(error);

    const addBtn = document.createElement("button");
    addBtn.textContent = "+ Ø¥Ø¶Ø§ÙØ© ÙˆØ±Ø¯";
    addBtn.className = "add-quran";

    addBtn.onclick = () => addEntry(qTd, error, date);

    qTd.appendChild(addBtn);

    if (saved?.quran) {
        saved.quran.forEach(q => {
            addEntry(qTd, error, date, q);
        });
    }

    tr.appendChild(qTd);
    tbody.appendChild(tr);

    function saveAll() {
        const data = {
            morning: morning.classList.contains("checked"),
            evening: evening.classList.contains("checked"),
            quran: []
        };

        qTd.querySelectorAll(".quran-entry").forEach(e => {
            const s = e.querySelector("select");
            const ins = e.querySelectorAll("input");
            data.quran.push({
                surah: s.value,
                from: ins[0].value,
                to: ins[1].value,
                done: e.classList.contains("read")
            });
        });

        saveAzkar(date, data);
    }

    morning.onclick = () => { morning.classList.toggle("checked"); saveAll(); };
    evening.onclick = () => { evening.classList.toggle("checked"); saveAll(); };

    function addEntry(container, errorBox, date, preset=null) {
        const last = container.querySelector(".quran-entry:last-of-type");
        if (last && !last.classList.contains("read")) {
            errorBox.textContent = "Ø§ÙƒÙ…Ù„ Ø§Ù„ÙˆØ±Ø¯ Ø§Ù„Ø³Ø§Ø¨Ù‚ Ø£ÙˆÙ„Ø§Ù‹";
            return;
        }
        errorBox.textContent = "";

        const div = document.createElement("div");
        div.className = "quran-entry";

        const sel = document.createElement("select");
        surahs.forEach(s=>{
            const o=document.createElement("option");
            o.value=s.n; o.textContent=s.n; o.dataset.max=s.a;
            sel.appendChild(o);
        });

        const from = document.createElement("input");
        from.type="number"; from.placeholder="Ù…Ù†";

        const to = document.createElement("input");
        to.type="number"; to.placeholder="Ø¥Ù„Ù‰";

        const doneBtn = document.createElement("button");
        doneBtn.textContent="ØªÙ…";
        doneBtn.className="mark";

        const editBtn = document.createElement("button");
        editBtn.textContent="ØªØ¹Ø¯ÙŠÙ„";
        editBtn.className="edit";

        const delBtn = document.createElement("button");
        delBtn.textContent="Ã—";
        delBtn.className="del";

        sel.onchange = () => {
            const max = +sel.selectedOptions[0].dataset.max;
            from.max = max;
            to.max = max;
        };

        doneBtn.onclick = () => {
            const max = +sel.selectedOptions[0].dataset.max;
            if (+from.value > max || +to.value > max) {
                errorBox.textContent = "Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ù„Ø¢ÙŠØ§Øª Ù‡Ø°Ù‡ Ø§Ù„Ø³ÙˆØ±Ø© Ù‡Ùˆ " + max;
                return;
            }
            div.classList.add("read");
            errorBox.textContent = "";
            saveAll();
        };

        editBtn.onclick = () => {
            div.classList.remove("read");
        };

        delBtn.onclick = () => {
            div.remove();
            saveAll();
        };

        if (preset) {
            sel.value = preset.surah;
            from.value = preset.from;
            to.value = preset.to;
            if (preset.done) div.classList.add("read");
        }

        div.append(sel, from, to, doneBtn, editBtn, delBtn);
        container.insertBefore(div, addBtn);
        saveAll();
    }
}

function wrap(el){
    const td = document.createElement("td");
    td.appendChild(el);
    return td;
}

function createBox(){
    const b = document.createElement("div");
    b.className = "box";
    return b;
}
</script>

</body>
</html>
