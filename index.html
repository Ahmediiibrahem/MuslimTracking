<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Prayer & Quran Tracker</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@700&display=swap" rel="stylesheet">
<style>
body {
    font-family: 'Cairo', sans-serif;
    font-weight: bold;
    direction: rtl;
    background-color: #121212;
    color: #e0e0e0;
    margin: 0;
    padding: 0;
}
.tabs {
    display: flex;
    border-bottom: 2px solid #444;
    margin-bottom: 10px;
    background-color: #1f1f1f;
}
.tab {
    padding: 12px 20px;
    cursor: pointer;
    color: #e0e0e0;
    border-right: 1px solid #444;
}
.tab:last-child { border-right: none; }
.tab.active { background-color: #4caf50; color: #fff; }
.tab-content { display: none; padding: 10px; }
.tab-content.active { display: block; }

table { width: 100%; border-collapse: collapse; margin-bottom: 20px; table-layout: fixed; display: block; overflow-x: auto; }
th, td { border: 1px solid #444; padding: 10px; text-align: center; vertical-align: middle; word-wrap: break-word; }
th { background-color: #1f1f1f; }
.box { width: 24px; height: 24px; border: 1px solid #888; display: flex; justify-content: center; align-items: center; cursor: pointer; font-size: 18px; margin: 0 auto; }
.checked::after { content: '✔'; color: #4caf50; }
.progress-bar { width: 100%; height: 20px; background-color: #333; border-radius: 4px; overflow: hidden; }
.progress-fill { height: 100%; width: 0%; background-color: #4caf50; transition: width 0.3s; text-align: center; line-height: 20px; color: #fff; font-weight: bold; }

.quran-entry { display: flex; flex-wrap: wrap; gap: 5px; align-items: center; margin-bottom: 5px; }
.quran-entry select, .quran-entry input { padding: 6px; font-weight: bold; text-align: center; border-radius: 4px; border: 1px solid #555; background-color: #1e1e1e; color: #e0e0e0; width: 80px; min-width: 60px; box-sizing: border-box; }
.quran-entry select:hover, .quran-entry input:hover { border-color: #4caf50; }
.add-quran { margin-top: 5px; padding: 6px 12px; background-color: #4caf50; border: none; color: #fff; cursor: pointer; font-weight: bold; font-size: 14px; }
.mark-read, .edit-quran, .delete-quran { margin-left: 5px; padding: 6px 10px; font-weight: bold; cursor: pointer; border-radius: 4px; font-size: 14px; }
.mark-read { background-color: #4caf50; color: #fff; }
.edit-quran { background-color: #ff9800; color: #fff; }
.delete-quran { background-color: #f44336; color: #fff; }
.quran-entry.read input, .quran-entry.read select { pointer-events: none; opacity: 0.6; background-color: #2e2e2e; }
.error-msg { color: #f44336; font-weight: bold; margin-top: 5px; }
</style>
</head>
<body>

<div class="tabs">
    <div class="tab active" data-tab="prayersTab">الصلوات اليومية</div>
    <div class="tab" data-tab="azkarTab">الأذكار والورد القرآني</div>
</div>

<div id="prayersTab" class="tab-content active">
    <h2>جدول الصلوات</h2>
    <table id="prayerTable">
    <thead>
        <tr>
            <th>اليوم</th>
            <th>الفجر</th>
            <th>الضحى</th>
            <th>الظهر</th>
            <th>العصر</th>
            <th>المغرب</th>
            <th>العشاء</th>
            <th>الإنجاز</th>
        </tr>
    </thead>
    <tbody></tbody>
    </table>
</div>

<div id="azkarTab" class="tab-content">
    <h2>جدول الأذكار والورد القرآني</h2>
    <table id="azkarTable">
    <thead>
        <tr>
            <th>اليوم</th>
            <th>أذكار الصباح</th>
            <th>أذكار المساء</th>
            <th>الورد القرآني</th>
        </tr>
    </thead>
    <tbody></tbody>
    </table>
</div>

<script>
// ---- Tabs logic ----
const tabs = document.querySelectorAll('.tab');
tabs.forEach(tab => {
    tab.addEventListener('click', () => {
        tabs.forEach(t => t.classList.remove('active'));
        tab.classList.add('active');
        document.querySelectorAll('.tab-content').forEach(tc => tc.classList.remove('active'));
        document.getElementById(tab.dataset.tab).classList.add('active');
    });
});

// ---- Prayer Table ----
const startDate = new Date('2026-01-01');
const endDate = new Date('2026-01-31');
const prayerTbody = document.querySelector('#prayerTable tbody');
const azkarTbody = document.querySelector('#azkarTable tbody');

function formatDate(d) {
    return d.toLocaleDateString('ar-EG');
}

for(let d = new Date(startDate); d <= endDate; d.setDate(d.getDate() + 1)) {
    const dateStr = formatDate(d);

    // --- الصلوات ---
    const pRow = document.createElement('tr');
    const dateCell = document.createElement('td'); dateCell.textContent = dateStr; pRow.appendChild(dateCell);

    const prayers = ['الفجر','الضحى','الظهر','العصر','المغرب','العشاء'];
    const boxes = [];

    prayers.forEach(() => {
        const cell = document.createElement('td');
        const box = document.createElement('div'); box.classList.add('box');
        cell.appendChild(box); pRow.appendChild(cell); boxes.push(box);
        box.addEventListener('click', () => {
            box.classList.toggle('checked');
            const checkedCount = boxes.filter(b => b.classList.contains('checked')).length;
            const percent = Math.round((checkedCount / boxes.length) * 100);
            progressFill.style.width = percent + '%';
            progressFill.textContent = (percent === 100) ? 'اكتمل' : percent + '%';
            localStorage.setItem('prayer-'+dateStr, JSON.stringify(boxes.map(b => b.classList.contains('checked'))));
        });
    });

    const progressCell = document.createElement('td');
    const progressBar = document.createElement('div'); progressBar.classList.add('progress-bar');
    const progressFill = document.createElement('div'); progressFill.classList.add('progress-fill');
    progressBar.appendChild(progressFill); progressCell.appendChild(progressBar); pRow.appendChild(progressCell);

    // Restore progress if exists
    const saved = localStorage.getItem('prayer-'+dateStr);
    if(saved) {
        const arr = JSON.parse(saved);
        arr.forEach((v,i) => { if(v) boxes[i].classList.add('checked'); });
        const percent = Math.round(arr.filter(Boolean).length / boxes.length * 100);
        progressFill.style.width = percent + '%';
        progressFill.textContent = (percent === 100) ? 'اكتمل' : percent + '%';
    }

    prayerTbody.appendChild(pRow);

    // --- الأذكار والورد ---
    const aRow = document.createElement('tr');
    const aDateCell = document.createElement('td'); aDateCell.textContent = dateStr; aRow.appendChild(aDateCell);

    ['أذكار الصباح','أذكار المساء'].forEach(key => {
        const cell = document.createElement('td');
        const box = document.createElement('div'); box.classList.add('box');
        cell.appendChild(box); aRow.appendChild(cell);
        box.addEventListener('click', () => {
            box.classList.toggle('checked');
            localStorage.setItem(key+'-'+dateStr, box.classList.contains('checked'));
        });
        // Restore
        const savedBox = localStorage.getItem(key+'-'+dateStr);
        if(savedBox === 'true') box.classList.add('checked');
    });

    const quranCell = document.createElement('td');
    const errorMsg = document.createElement('div'); errorMsg.classList.add('error-msg');
    quranCell.appendChild(errorMsg);

    const addButton = document.createElement('button');
    addButton.textContent = '+ إضافة ورد';
    addButton.classList.add('add-quran');

    addButton.addEventListener('click', () => {
        const entryDiv = document.createElement('div'); entryDiv.classList.add('quran-entry');

        const selectSurah = document.createElement('select');
        surahs.forEach(surah => {
            const option = document.createElement('option');
            option.value = surah.name;
            option.textContent = surah.name;
            option.dataset.ayat = surah.ayat;
            selectSurah.appendChild(option);
        });

        const fromInput = document.createElement('input'); fromInput.type='number'; fromInput.placeholder='من'; fromInput.min=1;
        const toInput = document.createElement('input'); toInput.type='number'; toInput.placeholder='إلى'; toInput.min=1;

        selectSurah.addEventListener('change', () => {
            const max = parseInt(selectSurah.selectedOptions[0].dataset.ayat);
            fromInput.max = max; toInput.max = max;
            if(parseInt(fromInput.value) > max) fromInput.value = max;
            if(parseInt(toInput.value) > max) toInput.value = max;
        });

        const markBtn = document.createElement('div'); markBtn.textContent='تم'; markBtn.classList.add('mark-read');
        const editBtn = document.createElement('div'); editBtn.textContent='تعديل'; editBtn.classList.add('edit-quran');
        const deleteBtn = document.createElement('div'); deleteBtn.textContent='×'; deleteBtn.classList.add('delete-quran');

        markBtn.addEventListener('click', () => {
            const max = parseInt(selectSurah.selectedOptions[0].dataset.ayat);
            if(fromInput.value>max || toInput.value>max){ errorMsg.textContent=`الحد الأقصى لآيات هذه السورة هو ${max}`; return; }
            entryDiv.classList.add('read'); errorMsg.textContent='';
            localStorage.setItem('quran-'+dateStr, quranCell.innerHTML);
        });

        editBtn.addEventListener('click', () => { entryDiv.classList.remove('read'); });
        deleteBtn.addEventListener('click', ()=>{ entryDiv.remove(); localStorage.setItem('quran-'+dateStr, quranCell.innerHTML); });

        entryDiv.appendChild(selectSurah); entryDiv.appendChild(fromInput); entryDiv.appendChild(toInput);
        entryDiv.appendChild(markBtn); entryDiv.appendChild(editBtn); entryDiv.appendChild(deleteBtn);

        quranCell.insertBefore(entryDiv, addButton);
    });

    quranCell.appendChild(addButton);
    aRow.appendChild(quranCell);
    azkarTbody.appendChild(aRow);

    // Restore Quran entries
    const savedQuran = localStorage.getItem('quran-'+dateStr);
    if(savedQuran) quranCell.innerHTML = savedQuran + ''; 
}
</script>

</body>
</html>
